"use strict";(self.webpackChunkreact_modele=self.webpackChunkreact_modele||[]).push([[179],{2871:(e,t,r)=>{var n=r(3935),o=r(8767),a=r(5998),s=r(9655),c=r(6042),i=(r(3415),r(9695)),l=r(7294),u=r(9250),d=r(5893);const p=function(){return(0,d.jsx)("div",{className:"",children:(0,d.jsx)(s.rU,{to:"/login",children:"login"})})};const f=function(){return(0,d.jsx)("main",{className:"page",children:(0,d.jsx)(p,{})})};r(7042),r(1539),r(8309),r(1038),r(8783),r(4916),r(2526),r(1817),r(2165),r(6992),r(3948),r(9753);const m=function(e){var t=e.className,r=e.text;return(0,d.jsx)("button",{type:"submit",className:"button ".concat(t),children:r})};const S=function(e){var t=e.type,r=e.className,n=e.id,o=e.placeholder,a=e.name,s=e.onChange,c=e.value,i=e.label;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("label",{htmlFor:n,children:i}),(0,d.jsx)("input",{type:t,className:r,id:n,placeholder:o,name:a,onChange:s,value:c})]})};r(1249);const g=function(e){var t=e.list,r=e.className,n=e.value;return t.map((function(e){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("input",{type:"radio",value:e.value,name:e.name,id:e.value,className:r,defaultChecked:n===e.value||""}),(0,d.jsx)("label",{id:e.value,htmlFor:e.value,children:e.value})]})}))};const h={position:"bottom-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"colored"};var _=r(3450);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const O=function(){var e=(0,a.I0)(),t=(0,a.v9)((function(e){return e.core.user})),r=t.username,n=t.password,o=(0,a.v9)((function(e){return e.core.apiUrl})),s=o.instance,i=o.protocol;return(0,d.jsx)("div",{className:"login",children:(0,d.jsxs)("form",{className:"login__form",onSubmit:function(t){t.preventDefault();var o=[],a=1;if(0===r.length&&(o.push("Le nom d'utilisateur est vide"),a=0),0===n.length&&(o.push("Le mot de passe est vide"),a=0),0===s.length&&(o.push("L'instance est vide"),a=0),0!==a){var i={username:r,password:n};e(_.Z.apiLoginCheck(i))}else{var l,u=v(o);try{for(u.s();!(l=u.n()).done;){var d=l.value;c.Am.error(d,h)}}catch(e){u.e(e)}finally{u.f()}}},children:[(0,d.jsx)("div",{className:"login__form__username",children:(0,d.jsx)(S,{type:"text",name:"username",className:"field username",id:"field__username",placeholder:"Nom d'utilisateur",onChange:function(t){return e(_.Z.setUsername(t.target.value))},value:r})}),(0,d.jsx)("div",{className:"login__form__password",children:(0,d.jsx)(S,{type:"password",name:"password",className:"field password",id:"field__password",placeholder:"Mot de passe",onChange:function(t){return e(_.Z.setPassword(t.target.value))},value:n})}),(0,d.jsx)("div",{className:"login__form__instance",children:(0,d.jsx)(S,{type:"text",name:"instance",className:"field instance",id:"field__instance",placeholder:"Instance",onChange:function(t){return e(_.Z.setInstance(t.target.value))},value:s})}),(0,d.jsx)("div",{className:"login__form__protocol",onChange:function(t){return e(_.Z.setProtocol(t.target.value))},children:(0,d.jsx)(g,{list:[{name:"protocol",value:"http"},{name:"protocol",value:"https"}],className:"protocol",value:i})}),(0,d.jsx)("div",{className:"login__form__submit",children:(0,d.jsx)(m,{text:"Se connecter"})})]})})};const y=function(){return(0,d.jsx)("main",{className:"page",children:(0,d.jsx)(O,{})})};const j=function(){return(0,d.jsxs)("main",{className:"page",children:[(0,d.jsx)(s.rU,{to:"/",children:"accueil"}),(0,d.jsx)(s.rU,{to:"/login",children:"login"})]})};const x=function(){var e=(0,a.I0)(),t=(0,u.TH)();return console.log("%c routes.js #12 || route : ","background:red;color:#fff;font-weight:bold;",t),(0,l.useEffect)((function(){localStorage.getItem("token")&&localStorage.getItem("instance")&&localStorage.getItem("protocol")?e(_.Z.apiLoadUser()):e(_.Z.destroySession())})),(0,d.jsxs)(u.Z5,{children:[(0,d.jsx)(u.AW,{exact:!0,path:"/",element:(0,d.jsx)(f,{})}),(0,d.jsx)(u.AW,{exact:!0,path:"/login",element:(0,d.jsx)(y,{})}),(0,d.jsx)(u.AW,{exact:!0,path:"*",element:(0,d.jsx)(j,{})})]})};var b=function(){var e=new o.QueryClient({defaultOptions:{queries:{staleTime:144e4,refetchOnWindowFocus:!0}}});return(0,d.jsx)(a.zt,{store:i.Z,children:(0,d.jsx)(o.QueryClientProvider,{client:e,children:(0,d.jsxs)(s.VK,{children:[(0,d.jsx)(x,{}),(0,d.jsx)(c.Ix,{icon:!1,style:{textAlign:"center",fontSize:"1.25rem",fontWeight:"bold"}})]})})})},I=(0,d.jsx)(b,{}),N=document.getElementById("root");(0,n.render)(I,N)},3450:(e,t,r)=>{r.d(t,{Z:()=>o});var n={API_LOGIN_CHECK:"API_LOGIN_CHECK",apiLoginCheck:function(e){return{type:n.API_LOGIN_CHECK,credentials:e}},API_LOAD_USER:"API_LOAD_USER",apiLoadUser:function(){return{type:n.API_LOAD_USER}},INSERT_USER:"INSERT_USER",insertUser:function(e){return{type:n.INSERT_USER,payload:e}},SET_API_URL:"SET_API_URL",setApiUrl:function(e){return{type:n.SET_API_URL,payload:e}},INSERT_LOCAL_STORAGE:"INSERT_LOCAL_STORAGE",insertLocalStorage:function(e){return{type:n.INSERT_LOCAL_STORAGE,payload:e}},DESTROY_SESSION:"DESTROY_SESSION",destroySession:function(){return{type:n.DESTROY_SESSION}},SET_USERNAME:"SET_USERNAME",setUsername:function(e){return{type:n.SET_USERNAME,username:e}},SET_PASSWORD:"SET_PASSWORD",setPassword:function(e){return{type:n.SET_PASSWORD,password:e}},SET_INSTANCE:"SET_INSTANCE",setInstance:function(e){return{type:n.SET_INSTANCE,instance:e}},SET_PROTOCOL:"SET_PROTOCOL",setProtocol:function(e){return{type:n.SET_PROTOCOL,protocol:e}}};const o=n},2758:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});r(1539),r(8674),r(8309);var n=r(6042),o=r(3450),a=(r(2222),r(1721)),s=r(9695),c=a.ZP.create({headers:{"Content-Type":"application/json"}});c.interceptors.request.use((function(e){var t=localStorage.getItem("token");e.headers.authorization=t?"Bearer ".concat(t):"";var r=localStorage.getItem("instance"),n=localStorage.getItem("protocol");r&&n&&(s.Z.dispatch(o.Z.setInstance(r)),s.Z.dispatch(o.Z.setProtocol(n)));var a=s.Z.getState().core.apiUrl,c=a.instance,i=a.protocol;return e.baseURL="".concat(i,"://").concat(c,"/api"),e}));const i=c;const l=function(e){return function(t){return function(r){switch(r.type){case o.Z.API_LOGIN_CHECK:var a=r.credentials;n.Am.dismiss();var s=new Promise((function(t,r){i.post("/login_check",a).then((function(r){var n=r.data,s=n.token,c=n.data,i=c.username,l=c.name;e.dispatch(o.Z.insertUser({username:i,name:l,isLogged:!0}));var u=e.getState().core.apiUrl,d=u.instance,p=u.protocol;e.dispatch(o.Z.insertLocalStorage({token:s,instance:d,protocol:p})),e.dispatch(o.Z.insertLocalStorage({username:a.username,password:a.password})),t("Vous êtes connecté !")})).catch((function(t){var n;e.dispatch(o.Z.destroySession()),console.log("%c core.js #30 || error : ","background:red;color:#fff;font-weight:bold;",t),void 0!==t.response.data.message&&(n=t.response.data.message,r(n)),r(n="Une erreur de connexion est survenue")}))}));n.Am.promise(s,{pending:"Connexion en cours ...",success:{render:function(e){return e.data}},error:{render:function(e){return e.data}}}),t(r);break;case o.Z.API_LOAD_USER:var c=new Promise((function(t,r){i.get("/user/profile").then((function(r){var n=r.data,a=n.username,s=n.name;e.dispatch(o.Z.insertUser({username:a,name:s,isLogged:!0})),t()})).catch((function(t){console.log("%c core.js #70 || e : ","background:red;color:#fff;font-weight:bold;",t.response);var n=localStorage.getItem("username"),a=localStorage.getItem("password");if(401===t.response.status&&"Unauthorized"===t.response.statusText&&""!==n&&""!==a){var s={username:n,password:a};e.dispatch(o.Z.apiLoginCheck(s)),r()}else e.dispatch(o.Z.destroySession()),r()}))}));n.Am.promise(c,{pending:"Chargement des données ..."}),t(r);break;default:t(r)}}}}},4637:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});r(7941),r(9070),r(2526),r(7327),r(1539),r(5003),r(9554),r(4747),r(9337),r(3321);var n=r(3450);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c={apiUrl:{instance:"",protocol:"https"},user:{username:"",password:"",name:"",isLogged:!1}};const i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case n.Z.INSERT_USER:return a(a({},e),{},{user:a(a({},e.user),t.payload)});case n.Z.INSERT_LOCAL_STORAGE:for(var r=Object.keys(t.payload),o=0,s=r;o<s.length;o++){var i=s[o];localStorage.setItem(i,t.payload[i])}return a({},e);case n.Z.DESTROY_SESSION:return localStorage.clear(),a({},e);case n.Z.SET_USERNAME:return a(a({},e),{},{user:a(a({},e.user),{},{username:t.username})});case n.Z.SET_PASSWORD:return a(a({},e),{},{user:a(a({},e.user),{},{password:t.password})});case n.Z.SET_INSTANCE:return a(a({},e),{},{apiUrl:a(a({},e.apiUrl),{},{instance:t.instance})});case n.Z.SET_PROTOCOL:return a(a({},e),{},{apiUrl:a(a({},e.apiUrl),{},{protocol:t.protocol})});default:return e}}},9695:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(5857),o=n.compose,a=n.applyMiddleware,s=n.createStore,c=n.combineReducers,i=[r(2758).default];const l=s(c({core:r(4637).default}),(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o)(a.apply(void 0,i)))},250:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[66],(()=>(t(250),t(2871))));e.O()}]);